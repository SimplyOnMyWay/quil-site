function m(a){return"number"==typeof a};function n(a){this.a=parseInt(a.substr(0,8),16);this.b=parseInt(a.substr(8,8),16);this.c=parseInt(a.substr(16,8),16);this.d=parseInt(a.substr(24,8),16)}function p(a){a.a|=0;a.b|=0;a.c|=0;a.d|=0;let c=(a.a+a.b|0)+a.d|0;a.d=a.d+1|0;a.a=a.b^a.b>>>9;a.b=a.c+(a.c<<3)|0;a.c=a.c<<21|a.c>>>11;a.c=a.c+c|0;return(c>>>0)/4294967296}let q=0;function r(a){a.h=!a.h;return a.h?p(a.i):p(a.j)}function t(a){return Math.floor((a+1-0)*r(u))}
function v(a,c){var d=u;let f,b;c=m(c)?c:1;if(d.g){var l=q;d.g=!1}else{do l=2*r(d)-1,f=2*r(d)-1,b=l*l+f*f;while(1<=b);b=Math.sqrt(-2*Math.log(b)/b);l*=b;q=f*b;d.g=!0}return l*c+(a||0)}function w(a,c){let d;d=r(u);return Math.pow(-(d*Math.pow(c,1.16)-d*Math.pow(a,1.16)-Math.pow(c,1.16))/(Math.pow(c,1.16)*Math.pow(a,1.16)),-1/1.16)}var u=new function(){this.h=!1;this.i=new n(tokenData.hash.substr(2,32));this.j=new n(tokenData.hash.substr(34,32));for(let a=0;1E6>a;a+=2)p(this.i),p(this.j);this.g=!1};
window.g=1;window.i=0;window.h=Array(window.g).fill(1);window.j=Array(window.g).fill(0);let x=null,y=[307.3,307.3*6/5,307.3*3/2,491.68,307.3*9/5,614.6,307.3*12/5];
async function aa(){if(!x)try{x=new AudioContext}catch(c){return null}try{var a=new AudioWorkletNode(x,"instrument-processor",{processorOptions:{f0s_:y}})}catch(c){try{await x.audioWorklet.addModule("js/instrument-processor-compiled.js"),a=new AudioWorkletNode(x,"instrument-processor",{processorOptions:{f0s_:y,RNG:u}})}catch(d){return null}}await x.resume();return a}
async function ba(){var a=await aa();if(a){a.connect(x.destination);a.port.onmessage=b=>{window.h[b.data.stringno]=b.data.amplitude;window.i=b.data.stringno};var c=function(b){a.port.postMessage({type:"play",stringnum:b})},d=Array(y.length),f=[4E3,8100,5600,12600,9200,14100,3100];d=[19700,17800,21300,22100,18400,2E4,17700].map(b=>1*b);for(let b=0;b<y.length;b++)setTimeout(()=>c(b),f[b]);for(let b=0;b<y.length;b++)setInterval(()=>{setTimeout(()=>c(b),1500+8500*r(u))},d[b])}}
window.addEventListener("load",()=>{document.getElementById("toggle").addEventListener("click",ca)});async function ca(){x?(window.h=Array(window.g).fill(1),await x.close(),x=null):ba()}var z=window.innerWidth,A=window.innerHeight,B=Math.min(z,A),C=(1+Math.sqrt(5))/2,D=Math.PI;function da(a,c){c=m(c)?c:C;return Math.pow(c,2*a/D)}
function ea(a,c){var d=(e=>k=>e+=k)(0),f=Array(100).fill(1);let b=f.reduce((e,k)=>e+k,0);d=f.map(e=>e/b).map(d).map(e=>e*c);f=[];let l=[];for(let e=0;100>=e;e++)f[e]=da(d[e],a),l[e]=[f[e]*Math.cos(d[e]),f[e]*Math.sin(d[e])];return l}var E=[[48,42,27,1],[208,65,74,1],[107,60,45,1],[79,83,74,1],[0,76,94,1]],F=E[t(E.length-1)],G=-.5*D,fa=-5*D/G,H=.125*D,ha=(3*D-D)/H,I=window.g,J=[0,0,0];for(let a=3;a<fa+3;a++)J[a]=(a-3)*G;var L=[];for(let a=0;a<ha;a++)L[a]=D+a*H;
var ia=Array(I).fill(0),M=Array(I).fill(0),N=Array(18).fill(0),O=Array(I).fill(0),P=Array(18).fill(0),Q=Array(I).fill(0),R=[0,0*r(u)],S=Array(I).fill(0),T=[.005,w(.005,.1)],U=Array(I).fill(0),V=[10,w(10,50)],W=[],X=Array(I).fill(0),Y=[],ja=[],ka=[],Z=[];for(let a=0;18>a;a++)N[a]=.5;for(let a=0;18>a;a++)P[a]=.5;
for(let a=0;a<I;a++){ia[a]=J[t(J.length-1)];M[a]=L[t(L.length-1)];O[a]=N[t(N.length-1)];Q[a]=P[t(P.length-1)];S[a]=R[t(R.length-1)];W[a]=V[t(V.length-1)];U[a]=T[t(T.length-1)];X[a]=.01>=U[a]&&.01>=S[a]?5E-4:.01<U[a]&&.05>U[a]&&.01>=S[a]?.001:5E-4;Y[a]=t(E.length-1);Z[a]=(C-1)/U[a];let c=[];for(let d=0;d<Z[a];d++)ka[d]=1+d*U[a],c[d]=ea(ka[d],M[a]);ja[a]=c}setup=function(){createCanvas(B,B);colorMode(HSB,360,100,100,1);frameRate(60)};
draw=function(){background(F[0],F[1],F[2],F[3]);noFill();for(let k=0;k<I;k++){var a=Math.pow(50*window.h[k],3);stroke(E[Y[k]][0],E[Y[k]][1],E[Y[k]][2],1<a?1:a);strokeWeight(z*X[k]);for(let K=0;K<Z[k];K++){a=ja[k][K];var c=S[k],d=5*W[k],f=O[k],b=Q[k],l=0[k],e=0[k];b=m(b)?b:.5;e=m(e)?e:0;f=(m(f)?f:.5)+v(0,m(l)?l:0);l=b+v(0,e);translate(z*f,A*l);beginShape();for(b=0;b<a.length;b++)e=a[b],e=[v(e[0],c)/d,v(e[1],c)/d],vertex(z*e[0],A*e[1]);endShape();translate(z*-f,A*-l)}}};
