function n(a){return"number"==typeof a};function p(a){this.a=parseInt(a.substr(0,8),16);this.b=parseInt(a.substr(8,8),16);this.c=parseInt(a.substr(16,8),16);this.d=parseInt(a.substr(24,8),16)}function q(a){a.a|=0;a.b|=0;a.c|=0;a.d|=0;let c=(a.a+a.b|0)+a.d|0;a.d=a.d+1|0;a.a=a.b^a.b>>>9;a.b=a.c+(a.c<<3)|0;a.c=a.c<<21|a.c>>>11;a.c=a.c+c|0;return(c>>>0)/4294967296}let r=0;function t(a){a.h=!a.h;return a.h?q(a.i):q(a.j)}function u(a,c){return Math.floor(a+(c+1-a)*t(v))}
function w(a,c){var d=v;let f,b;c=n(c)?c:1;if(d.g){var m=r;d.g=!1}else{do m=2*t(d)-1,f=2*t(d)-1,b=m*m+f*f;while(1<=b);b=Math.sqrt(-2*Math.log(b)/b);m*=b;r=f*b;d.g=!0}return m*c+(a||0)}function x(a,c){let d;d=t(v);return Math.pow(-(d*Math.pow(c,1.16)-d*Math.pow(a,1.16)-Math.pow(c,1.16))/(Math.pow(c,1.16)*Math.pow(a,1.16)),-1/1.16)}var v=new function(){this.h=!1;this.i=new p(tokenData.hash.substr(2,32));this.j=new p(tokenData.hash.substr(34,32));for(let a=0;1E6>a;a+=2)q(this.i),q(this.j);this.g=!1};
window.g=7;window.i=0;window.h=Array(window.g).fill(1);window.j=Array(window.g).fill(0);let z=null,A=[307.3,307.3*6/5,307.3*3/2,491.68,307.3*9/5,614.6,307.3*12/5];
async function aa(){if(!z)try{z=new AudioContext}catch(c){return null}try{var a=new AudioWorkletNode(z,"instrument-processor",{processorOptions:{f0s_:A}})}catch(c){try{await z.audioWorklet.addModule("js/instrument-processor-compiled.js"),a=new AudioWorkletNode(z,"instrument-processor",{processorOptions:{f0s_:A,RNG:v}})}catch(d){return null}}await z.resume();return a}
async function ba(){var a=await aa();if(a){a.connect(z.destination);a.port.onmessage=b=>{window.h[b.data.stringno]=b.data.amplitude;window.i=b.data.stringno};var c=function(b){a.port.postMessage({type:"play",stringnum:b})},d=Array(A.length),f=[4E3,8100,5600,12600,9200,14100,3100];d=[19700,17800,21300,22100,18400,2E4,17700].map(b=>1*b);for(let b=0;b<A.length;b++)setTimeout(()=>c(b),f[b]);for(let b=0;b<A.length;b++)setInterval(()=>{setTimeout(()=>c(b),1500+8500*t(v))},d[b])}}
window.addEventListener("load",()=>{document.getElementById("toggle").addEventListener("click",ca)});async function ca(){z?(window.h=Array(window.g).fill(1),await z.close(),z=null):ba()}var B=window.innerWidth,C=window.innerHeight,D=Math.min(B,C),E=(1+Math.sqrt(5))/2,F=Math.PI;function G(a,c){c=n(c)?c:E;return Math.pow(c,2*a/F)}var H=[[48,42,27,1],[208,65,74,1],[107,60,45,1],[79,83,74,1],[0,76,94,1]],I=[220,80,60,1],J=-.5*F,da=-5*F/J,L=.125*F,ea=(3*F-F)/L,M=window.g,N=[0,0,0];
for(let a=3;a<da+3;a++)N[a]=(a-3)*J;var O=[];for(let a=0;a<ea;a++)O[a]=F+a*L;var fa=Array(M).fill(0),ha=Array(M).fill(0),P=Array(18).fill(0),ia=Array(M).fill(0),S=Array(18).fill(0),ja=Array(M).fill(0),ka=[0,0*t(v)],T=Array(M).fill(0),la=[.005,x(.005,.1)],U=Array(M).fill(0),ma=[10,x(10,50)],V=[],na=Array(M).fill(0),W=[],oa=[],va=[],X=[];for(let a=0;18>a;a++)P[a]=.5;for(let a=0;18>a;a++)S[a]=.5;
for(let a=0;a<M;a++){var wa=a,xa,ya=N;xa=ya[u(0,ya.length-1)];fa[wa]=xa;ha[a]=O[u(0,O.length-1)];ia[a]=P[u(0,P.length-1)];ja[a]=S[u(0,S.length-1)];T[a]=ka[u(0,ka.length-1)];V[a]=ma[u(0,ma.length-1)];U[a]=la[u(0,la.length-1)];na[a]=.01>=U[a]&&.01>=T[a]?5E-4:.01<U[a]&&.05>U[a]&&.01>=T[a]?.001:5E-4;W[a]=u(1,H.length-1);X[a]=(E-1)/U[a];let c=[];for(let d=0;d<X[a];d++){va[d]=1+d*U[a];var za=c,Aa=d,Ba=va[d],Ca=fa[a],Y=ha[a],Da=V[a],Z=Ba;let f=[0],b=[0],m=G(0,Z),l=G(Y,Z),k=Y/(Y-Ca),y=50*k,pa=50*(1-k);console.log("s,e,N, NPos,NNeg,r0,re = ",
Ca,Y,50,y,pa,m,l);let qa=.1*Da,ra=Math.pow(Z,3),Q=Math.trunc(y*ra/qa),sa=Y/(2*F)*F*(2*l+2*m)/2/Q;for(let e=1;e<Q;e++)f[e]=f[e-1]+sa/G(f[e-1],Z);f.shift();console.log("thetaVecPos = ",f);let ta=Math.trunc(pa*ra/qa);console.log("NPosScaled,NNegScaled = ",Q,ta);for(let e=1;e<ta;e++)b[e]=b[e-1]-sa/G(b[e-1],Z);b=b.reverse();console.log("thetaVecNeg = ",b);let K=b.concat(f),R=[],ua=[];for(let e=0;e<K.length;e++)R[e]=G(K[e],Ba),ua[e]=[R[e]*Math.cos(K[e]),R[e]*Math.sin(K[e])];za[Aa]=ua}oa[a]=c}
setup=function(){createCanvas(D,D);colorMode(HSB,360,100,100,1);frameRate(60)};
draw=function(){background(I[0],I[1],I[2],I[3]);noFill();for(let k=0;k<M;k++){var a=Math.pow(50*window.h[k],3);stroke(H[W[k]][0],H[W[k]][1],H[W[k]][2],1<a?1:a);strokeWeight(B*na[k]);for(let y=0;y<X[k];y++){a=oa[k][y];var c=T[k],d=5*V[k],f=ia[k],b=ja[k],m=0[k],l=0[k];b=n(b)?b:.5;l=n(l)?l:0;f=(n(f)?f:.5)+w(0,n(m)?m:0);m=b+w(0,l);translate(B*f,C*m);beginShape();for(b=0;b<a.length;b++)l=a[b],l=[w(l[0],c)/d,w(l[1],c)/d],vertex(B*l[0],C*l[1]),point(B*l[0],C*l[1]);endShape();translate(B*-f,C*-m)}}};
